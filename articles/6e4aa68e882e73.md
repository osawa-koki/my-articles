---
title: "AWS Lambdaの構築はTerraformではなく、SAMで！"
emoji: "🕌"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["AWS", "Terraform", "AWS SAM"]
published: true
---

## LambdaはSAMで

タイトルの通りですが、「LambdaはSAMで」ということです。  
Terraformでの構築は嫌いです。  

## なぜ

Lambdaは関数リソース作成時に、関数コードが必要となるからです。  

通常は、以下の2つのステップで構築します。  

1. Terraformでのリソースの構築
2. CI/CDでの継続的デプロイ

Lambdaは1の段階で関数コードを指定する必要があります。  
そのため、CI/CDでの継続的デプロイが困難です。  

Terraformでの構築後に、Lambdaの関数コードを更新可能ですが、そこまでする必要があるのか疑問です。  

さらには、IaC(IaC: Infrastructure as Code)の考え方に反するとも言えます。  
これは、Terraformによってインフラ以外のコードを管理することになるためです。  

## SAMでの構築

SAMは、AWSが提供している、LambdaのIaCツールです。  
SAMはTerraformとは異なり、AWSのサービスに特化したツールで、リソースの構築だけでなく、CI/CDの構築も容易です。  

クラウドプロバイダ間の差異を吸収してくれるTerraformが好きですが、Lambdaに関してはSAMを使うべきです。  

---

AzureではAzure Functionsを使うことが多いのですが、Azure FunctionsはTerraformでの構築が可能です。  
これは、Azure Functionsは関数コードを指定する必要がないためです。  

関数アプリと呼ばれる関数のコンテナリソースをTerraformで構築し、その中に関数を登録するという形になります。  
したがって、リソース構築時に関数コードを指定する必要がないため、IaCとしてのTerraformの考え方に沿っています。  
また、このように構築しても、CI/CDでの継続的デプロイが可能です。  
