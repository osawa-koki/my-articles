---
title: "GraphQLとは？"
---

## GraphQLとは

GraphQL は、Meta(旧 Facebook)社が開発したデータ取得・更新用のクエリ言語です。  
従来の REST API に代わるものとして注目を集めています。  

API に関するクエリ言語としての意味合いを持ち、サーバー側で定義したレスポンス形式のみを返すことができる REST API とは異なり、クライアント側で必要なデータを指定して取得できます。  
したがって、クライアントサイドで必要とされるデータを、その通りに取得できます。  
クライアントサイドで複雑なデータが必要となってきている現代の Web アプリケーションにおいて、REST API の代替として注目されています。  

## 従来のREST APIの問題点

- クライアントが不要なデータも取得してしまう。(オーバーフェッチ)
- クライアントが不足しているデータを取得するために複数回リクエストを送る必要がある。(アンダーフェッチ)
- サーバー側のデータ型とクライアント側のデータ型を同期させるのが大変。

### オーバーフェッチ

オーバーフェッチとは、クライアントが必要としていないデータを取得してしまうことです。  
ユーザー名一覧を表示するために、`/users`というエンドポイントにリクエストを送ったとします。  
大抵の場合、ユーザー名以外の情報は不要ですが、REST API ではユーザー名以外のプロパティも返すように実装されていることが多いです。  

以下のようなレスポンスが返ってくるでしょう。  

```rest
GET /users

[
  {
    "id": 1,
    "name": "John",
    "age": 20,
    "address": "Tokyo"
  },
  {
    "id": 2,
    "name": "Bob",
    "age": 25,
    "address": "Osaka"
  },
  {
    "id": 3,
    "name": "Alice",
    "age": 30,
    "address": "Fukuoka"
  }
]
```

この中から`name`プロパティだけを取り出して処理されるでしょうが、`age`や`address`のような不要なデータも取得してしまっているのがオーバーフェッチです。  

### アンダーフェッチ

アンダーフェッチとは、クライアントが必要としているデータを取得するために複数回リクエストを送ることです。  
今度は、ユーザー名と当該ユーザーの投稿一覧を表示するために、`/users`というエンドポイントにリクエストを送ったとします。  

しかしながら、先ほどのレスポンスには投稿一覧の情報が含まれていません。  
ユーザー名一覧を取得するためには、最初に`/users`へリクエストを送り、そのレスポンスからユーザー ID を取り出して、`/users/:id/posts`にリクエストを送る必要があります。  

このように、複数回リクエストを送る必要が出てきてしまう問題がアンダーフェッチです。  

### データ型の同期

REST API では、サーバー側のデータ型とクライアント側のデータ型を同期させる必要があります。  
データ型のない JavaScript では特に問題になりません。  

しかし、TypeScript などの静的型付け言語を使っている場合は、サーバー側で定義したデータ型と全く同じものをクライアント側でも定義する必要があります。  

例えば、ユーザー型を定義するためにサーバーサイドで以下のデータ型を定義したとします。  

```ts
interface User {
  id: number;
  name: string;
  age: number;
  address: string;
}
```

これと全く同じデータ型をクライアント側でも定義する必要があります。  

これには、作業工数の増加や、サーバー側のデータ型を変更した場合にクライアント側も変更する必要があるという問題があります。  
必然的にミスが発生しやすくなります。  

GraqlQL では、サーバー側で定義したデータ型をクライアント側でもそのまま使うことができます。  
そのため、データ型の同期による問題を解決できます。  
